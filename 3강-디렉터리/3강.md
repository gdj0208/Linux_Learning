# ë¦¬ëˆ…ìŠ¤ì™€ ë””ë ‰í„°ë¦¬

## 1ï¸âƒ£ ë¦¬ëˆ…ìŠ¤ ë””ë ‰í„°ë¦¬

### ğŸ¯ë¦¬ëˆ…ìŠ¤ì˜ íŒŒì¼ êµ¬ë¶„
![alt text](image-1.png)
ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ë¶„ë¥˜í•œë‹¤.
- ì¼ë°˜ íŒŒì¼
- íŠ¹ìˆ˜ íŒŒì¼
- ë””ë ‰í„°ë¦¬

### ğŸ¯ ë¦¬ëˆ…ìŠ¤ì˜ íŒŒì¼ êµ¬ì„±
- íŒŒì¼ëª… : ì‚¬ìš©ìê°€ íŒŒì¼ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©
- Inode : ê°ì¢… íŒŒì¼ ì •ë³´ì™€ ë°ì´í„° ë¸”ë¡ ì£¼ì†Œë“¤ ë“±ì„ ì €ì¥
- ë°ì´í„° ë¸”ë¡ : ì‹¤ì œë¡œ ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” í•˜ë“œë””ìŠ¤í¬ ê³µê°„

![Inodeì˜ êµ¬ì„± ì˜ˆì‹œ](image.png)
<br>
---

## 2ï¸âƒ£ íŒŒì¼ì˜ ì¢…ë¥˜ì™€ êµ¬ì„±

### ğŸ¯ ë¦¬ëˆ…ìŠ¤ íŒŒì¼ì˜ ì¢…ë¥˜
#### **1. ì¼ë°˜ íŒŒì¼**
- í…ìŠ¤íŠ¸ íŒŒì¼, ì‹¤í–‰ íŒŒì¼, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“± ë¦¬ëˆ…ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ íŒŒì¼
- ë°ì´í„° ë¸”ë¡ì— í…ìŠ¤íŠ¸ë‚˜ ë°”ì´ë„ˆë¦¬ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ì €ì¥
- viì™€ ê°™ì€ í¸ì§‘ê¸°ë¥¼ ì‚¬ìš©í•´ ë§Œë“¤ìˆ˜ë„, ì»´íŒŒì¼ëŸ¬ë‚˜ ë‹¤ë¥¸ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ ìƒì„±ë„ ê°€ëŠ¥

#### **2. íŠ¹ìˆ˜ íŒŒì¼**
- í†µì‹ ì„ í•˜ê±°ë‚˜ í„°ë¯¸ë„, ë””ìŠ¤í¬ ë“±ì˜ ì¥ì¹˜ ì‚¬ìš©í•  ë•Œ ì´ìš©í•˜ëŠ” íŒŒì¼
- ì¥ì¹˜ì˜ ì¢…ë¥˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¥ì¹˜ ë²ˆí˜¸ë¥¼ inodeì— ì €ì¥
- ë°ì´í„° ë¸”ë¡ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©°, ë¸”ë¡ ì¥ì¹˜ íŒŒì¼ê³¼ ë¬¸ì ì¥ì¹˜ íŒŒì¼ì´ ìˆìŒ
    - ë¸”ë¡ ì¥ì¹˜ íŒŒì¼ì€ ë¸”ë¡ ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ ì½ê³  ì“´ë‹¤.
    - ë¬¸ì ì¥ì¹˜ íŒŒì¼ì€ í•˜ë“œ ë””ìŠ¤í¬ì¸ ê²½ìš° ì„¹í„° ë‹¨ìœ„ë¡œ ì½ê³  ì“´ë‹¤.

#### **3. ë””ë ‰í„°ë¦¬**
- ë¦¬ëˆ…ìŠ¤ì—ì„  ë””ë ‰í„°ë¦¬ë„ íŒŒì¼ë¡œ ì·¨ê¸‰
- ë°ì´í„° ë¸”ë¡ì€ í•´ë‹¹ ì´ë ‰í„°ë¦¬ì— ì†í•œ íŒŒì¼ ëª©ë¡ê³¼ inodeë¥¼ ì €ì¥
<br>


### ğŸ¯ ë¦¬ëˆ…ìŠ¤ íŒŒì¼ì˜ êµ¬ì„± ìš”ì†Œ
#### 1. íŒŒì¼ëª…
- ì‚¬ìš©ìê°€ íŒŒì¼ì— ì ‘ê·¼ ì‹œ íŒŒì¼ëª…ê³¼ ê´€ë ¨ëœ inodeê°€ í•„ìš”ë¡œ í•¨
- íŒŒì¼ëª… ì§€ì • ì‹œ ì£¼ì˜ì‚¬í•­
    1. íŒŒì¼ëª…ê³¼ ë””ë ‰í„°ë¦¬ëª…ì— ì‚¬ìš©ë˜ëŠ” ì•ŒíŒŒë²³ì€ ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„
    2. íŒŒì¼ëª…ê³¼ ë””ë ‰í„°ë¦¬ëª…ì´ '.'ìœ¼ë¡œ ì‹œì‘ë˜ë©´ ìˆ¨ê¹€ íŒŒì¼ë¡œ ê°„ì£¼

#### 2. Inode
- íŒŒì¼ì— ëŒ€í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´
- ë””ìŠ¤í¬ì— ì €ì¥ë˜ì–´ ìˆìŒ

    ![Inodeì˜ êµ¬ì„±](image-2.png)
<br>
---

## 3ï¸âƒ£ ë””ë ‰í„°ë¦¬ ëª…ë ¹ì–´

### ğŸ¯ mkdir
#### **1. ì½”ë“œ ì˜ˆì‹œ**
```
#include <sys/stat.h>
#include <sys/types.h>

int mkdir(const char *pathname, mode_t mode);
```
- pathname : ë””ë ‰í„°ë¦¬ê°€ í¬í•¨ëœ ê²½ë¡œ
- mode : ì ‘ê·¼ ê¶Œí•œ

#### **2. mkdir ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : ìƒì„±í•˜ë ¤ëŠ” ë””ë ‰í„°ë¦¬ëª…ì„ í¬í•¨í•œ ê²½ë¡œ, ê¸°ë³¸ ì ‘ê·¼ ê¶Œí•œ
- ë°˜í™˜ : \
    0 : ìˆ˜í–‰ ì„±ê³µ \
    -1 : ì‹¤íŒ¨ 

#### **3. mkdir ì˜ˆì œ**
```
#include <sys/stat.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {

    if (mkdir("testdir", 0755) == -1) {
            perror ("testdir");
            exit(1);
    }
}
```
<br>

### ğŸ¯ rmdir
#### **1. ì½”ë“œ ì˜ˆì‹œ**
```
#include <sys/stat.h>
#include <sys/types.h>

int rmdir(const char *pathname);
```
- pathname : ë””ë ‰í„°ë¦¬ê°€ í¬í•¨ëœ ê²½ë¡œ

#### **2. rmdir ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : ìƒì„±í•˜ë ¤ëŠ” ë””ë ‰í„°ë¦¬ëª…ì„ í¬í•¨í•œ ê²½ë¡œ
- ë°˜í™˜ : \
    0 : ìˆ˜í–‰ ì„±ê³µ \
    -1 : ì‹¤íŒ¨ 

#### **3. mkdir ì˜ˆì œ**
```
#include <sys/stat.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {

    if (mkdir("testdir", 0755) == -1) {
            perror ("testdir");
            exit(1);
    }
}
```
<br>

### ğŸ¯ getcwd
#### **1. getcwd ì˜ˆì œ**
```
#include <sys/stat.h>

char *getcwd(char *buf, size_t size);
```
- buf : í˜„ì¬ ë””ë ‰í„°ë¦¬ì˜ ì ˆëŒ€ê²½ë¡œë¥¼ ì €ì¥í•  ë²„í¼ì£¼ì†Œ
- size : ë²„í¼ì˜ í¬ê¸°

#### **2. getcwd ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : ì €ì¥í•˜ë ¤ëŠ” ë””ë ‰í„°ë¦¬ëª…ì„ í¬í•¨í•œ ê²½ë¡œ, ë²„í¼ì˜ í¬ê¸°
- ë°˜í™˜ : í˜„ì¬ dir

#### **3. getcwd ì˜ˆì œ**
```
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {
     char *cwd;
     char wd1[BUFSIZ];
     char wd2[64];

     getcwd(wd1, BUFSIZ);
     printf("wd1 = %s\n", wd1);

     cwd = getcwd(NULL, BUFSIZ);
     printf("cwd1 = %s\n", cwd);
     free(cwd);

     cwd = getcwd(NULL, 0);
     printf("cwd2 = %s\n", cwd);
     free(cwd);

     if(getcwd(wd2, 10) == NULL) {
         perror("getcwd");
         exit(1);
     }
}
/*
ì‹¤í–‰ ê²°ê³¼ : 
wd1 = /home/jw/src/ch2
cwd1 = /home/jw/src/ch2
cwd2 = /home/jw/src/ch2
getcwd: Numerical result out of range
*/
```
- BUFSIZëŠ” stdio.hì—ì„œ 8192(8kb)ë¡œ ì •ì˜ ë˜ì–´ìˆë‹¤.
<br>
<br>

### ğŸ¯ get_current_dir_name
#### **1. getcwd ì˜ˆì œ**
```
#include <unistd.h>

char *get_current_dir_name();
```

#### **2. getcwd ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ë°˜í™˜ : í˜„ì¬ ë””ë ‰í„°ë¦¬ì˜ ì ˆëŒ€ ê²½ë¡œ

#### **3. getcwd ì˜ˆì œ**
```
#define _GNU_SOURCE
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {
    char *cwd;

    cwd = get_current_dir_name();
    printf("cwd = %s\n", cwd);
    free(cwd);
}
/*
ì‹¤í–‰ ê²°ê³¼ : 
cwd = /home/jw/src/ch2
*/
```
<br>

### ğŸ¯ rename
#### **1. rename ì˜ˆì œ**
```
#include <stido.h>

int rename(const char *oldpath, const char *newpath);
```

#### **2. rename ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - oldpath : ë³€ê²½í•  íŒŒì¼/ë””ë ‰í„°ë¦¬
    - newpath : ìƒˆ íŒŒì¼/ë””ë ‰í„°ë¦¬
- ë°˜í™˜ : 
    - 0 : ìˆ˜í–‰ ì„±ê³µ
    - -1 : ìˆ˜í–‰ ì‹¤íŒ¨

- newpathê°€ ë¹ˆê°’ì´ë©´ oldpathë¥¼ ì‚­ì œ
- ì˜¤ë¥˜ ë°œìƒì‹œ ì›ë³¸ê³¼ ìƒˆë¡œìš´ ë””ë ‰í„° ëª¨ë‘ ë‚¨ìŒ

#### **3. rename ì˜ˆì œ**
```
#include <sys/stat.h>
#include <stdio.h>
#include <stdlib.h>

int main() {
     if(rename("oldname.txt", "newname.txt") == -1) {
         perror("Error renaming file");
         exit(1);
     }
}


```
<br>

### ğŸ¯ chdir
#### **1. chdir ì˜ˆì œ**
```
#include <unistd.h>

int chdir(const char *path);
```

#### **2. chdir ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - path : ì´ë™í•˜ë ¤ëŠ” ë””ë ‰í„°ë¦¬ ê²½ë¡œ
    - ìƒëŒ€ê²½ë¡œ, ì ˆëŒ€ê²½ë¡œ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥
- ë°˜í™˜ : 
    - 0 : ìˆ˜í–‰ ì„±ê³µ
    - -1 : ìˆ˜í–‰ ì‹¤íŒ¨

#### **3. chdir ì˜ˆì œ**
```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main() {
     char *cwd;

     cwd = getcwd(NULL, BUFSIZ);
     printf("1.Current Directory: %s\n", cwd);

     chdir("testdir");

     cwd = getcwd(NULL, BUFSIZ);
     printf("2.Current Directory: %s\n", cwd);

     free(cwd);
}
```
<br>

### ğŸ¯ fchdir
#### **1. fchdir ì˜ˆì œ**
```
#include <unistd.h>

int fchdir(int fd);
```

#### **2. fchdir ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - fd : ì´ë™í•˜ë ¤ëŠ” ë””ë ‰í„°ë¦¬ì˜ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°
    - open() í•¨ìˆ˜ë¡œ í•´ë‹¹ ë””ë ‰í„°ë¦¬ì˜ ë””ìŠ¤í¬ë¦½í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- ë°˜í™˜ : 
    - 0 : ìˆ˜í–‰ ì„±ê³µ
    - -1 : ìˆ˜í–‰ ì‹¤íŒ¨

#### **3. fchdir ì˜ˆì œ**
```
#include <fcntl.h>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main() {
     char *cwd;
     int fd;

     cwd = getcwd(NULL, BUFSIZ);
     printf("1.Current Directory: %s\n", cwd);

     fd = open("testdir", O_RDONLY);
     fchdir(fd);

     cwd = getcwd(NULL, BUFSIZ);
     printf("2.Current Directory: %s\n", cwd);

     close(fd);
     free(cwd);
}

```
<br>

### ğŸ¯ ê·¸ ì™¸ì˜ ë””ë ‰í„°ë¦¬ ëª…ë ¹ì–´
#### 1. opendir()
```
#include <sys/types.h>
#include <dirent.h>

DIR *opendir(const char *name);
```
#### 2. opendir()
```
#include <sys/types.h>
#include <dirent.h>

int closedir(DIR * dir);
```
#### 3. opendir()
```
#include <dirent.h>

struct dirent *readdir(DIR *dir);
```
<br>

---

## 4ï¸âƒ£ Inode ìƒíƒœ ë³´ê¸°
### ğŸ¯ Inode ë‹¤ë£¨ê¸°
#### 1. Inode ì •ë³´ ê²€ìƒ‰
```
// íŒŒì¼ ì •ë³´ ê²€ìƒ‰

int stat(const char *pathname, struct stat *statbuf);
int fstat(int fd, struct stat *statbuf);
```

#### 2. Inode ì ‘ê·¼ ê¶Œí•œ ì •ë³´ í™•ì¸
```
// íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ í™•ì¸
int access(const char *pathname, int mode);

// íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ í¸ê²½
int chmod(const cahr *pathname, mode_t mode);
int fchmod(int fd, mode_t mode);
```

#### 3. ë§í¬ í•¨ìˆ˜
- ë§í¬ : ê¸°ì¡´ íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ì´ë¦„ì„ ì˜ë¯¸
```
// í•˜ë“œ ë§í¬ ìƒì„±
int link(const char *oldpath, const char *newpath);

// ì‹¬ë²Œë¦­ ë§í¬ ìƒì„±
int symlink(const char *target, const char *linkpath);

// ì‹¬ë²Œë¦­ ë§í¬ ì •ë³´ ê²€ìƒ‰
int lstat(const char *pathname, struct stat *statbuf);

// ì‹¬ë²Œë¦­ ë§í¬ ë‚´ìš© ì½ê¸°
ssize_+_t readlink(const char *pathname, char *buf, size_t bufsize);

// ì‹¬ë²Œë¦­ ë§í¬ ì›ë³¸ íŒŒì¼ì˜ ê²½ë¡œ ê²€ìƒ‰
char *realpath(const char *path, char *resolved_path);

// ë§í¬ ëŠê¸°
int unlink(const char *pathname);
```

<br>

## 5ï¸âƒ£ íŒŒì¼ ì •ë³´ ê²€ìƒ‰

### ğŸ¯ stat : íŒŒì¼ëª…ìœ¼ë¡œ íŒŒì¼ ì •ë³´ ê²€ìƒ‰
#### **0. stat êµ¬ì¡°ì²´**
- stat() í•¨ìˆ˜ëŠ” ê²€ìƒ‰í•œ inode ì •ë³´ë¥¼ stat êµ¬ì¡°ì²´ì— ì €ì¥í•˜ì—¬ ë°˜í™˜í•œë‹¤
- <sys/stat.h> í—¤ë” íŒŒì¼ì„ í¬í•¨
- stat.c íŒŒì¼ ì°¸ê³ 

<br>

[ Stat êµ¬ì¡°ì²´ì˜ êµ¬ì„± ]
- st_dev : íŒŒì¼ì´ ì €ì¥ë˜ì–´ìˆëŠ” ì¥ì¹˜ì˜ ë²ˆí˜¸
- st_ino : íŒŒì¼ì˜ inode ë²ˆí˜¸
- st_mode : íŒŒì¼ì˜ ì¢…ë¥˜ì™€ ì ‘ê·¼ ê¶Œí•œ
- st_nlink : í•˜ë“œ ë§í¬ì˜ ê°œìˆ˜
- st_uid : íŒŒì¼ ì†Œìœ ìì˜ UID
- st_gid : íŒŒì¼ ì†Œìœ  ê·¸ë£¹ì˜ GID 
- st_rdev : ì£¼ ì¥ì¹˜ë²ˆí˜¸, ë¶€ ì¥ì¹˜ë²ˆí˜¸
- st_blksize : íŒŒì¼ ë‚´ìš© ì…ì¶œë ¥ì‹œ ì‚¬ìš©ë˜ëŠ” ë²„í¼ í¬ê¸°
- st_blocks : íŒŒì¼ì— í• ë‹¹ëœ íŒŒì¼ ì‹œìŠ¤í…œ ë¸”ë¡ ìˆ˜ (512 byte)
- timespec : ì´ˆ, ë‚˜ë…¸ì´ˆë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ êµ¬ì¡°ì²´
    ```
    struct timespec {
        _kernel_time_t tv_sec;  // ì´ˆ
        long tc_nsec;           // ë‚˜ë…¸ì´ˆ
    }
    ```
- st_atime : ë§ˆì§€ë§‰ìœ¼ë¡œ íŒŒì¼ì„ ì½ê±°ë‚˜ ì‹¤í–‰í•œ ì‹œê° (timespec êµ¬ì¡°ì²´)
- st_mtime : ë§ˆì§€ë§‰ìœ¼ë¡œ íŒŒì¼ì˜ ë‚´ìš©ì„ ë³€ê²½í•œ ì‹œê°
- st_ctime : ë§ˆì§€ë§‰ìœ¼ë¡œ inodeì˜ ë‚´ìš©ì„ ë³€ê²½í•œ ì‹œê°

#### **1.  ì˜ˆì œ**
```
# include <sys/types.h>
# include <sys/stat.h>

int stat(const char *pathname, struct stat *statbuf);
```
- íŒŒì¼ì— ì´ë¥´ëŠ” ê²½ë¡œì˜ ê° ë””ë ‰í„°ë¦¬ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œ í•„ìš”

#### **2. ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - pathname : ì •ë³´ë¥¼ ì•Œê³ ìí•˜ëŠ” íŒŒì¼ëª…
    - statbuf : ê²€ìƒ‰í•œ íŒŒì¼ ì •ë³´ë¥¼ ì €ì¥í•  êµ¬ì¡°ì²´ ì£¼ì†Œ
- ë°˜í™˜ : 
    - 0 : ì„±ê³µ
    - -1 : ì‹¤íŒ¨

#### **3. ì½”ë“œ ì˜ˆì œ**
```
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
#include <stdio.h>

int main() {
     struct stat statbuf;

     stat("test.txt", &statbuf);

     printf("Inode = %d\n", (int)statbuf.st_ino);
     printf("Mode = %o\n", (unsigned int)statbuf.st_mode);
     printf("Nlink = %o\n",(unsigned int) statbuf.st_nlink);
     printf("UID = %d\n", (int)statbuf.st_uid);
     printf("GID = %d\n", (int)statbuf.st_gid);
     printf("SIZE = %d\n", (int)statbuf.st_size);
     printf("Blksize = %d\n", (int)statbuf.st_blksize);
     printf("Blocks = %d\n", (int)statbuf.st_blocks);

     printf("** timespec Style\n");
     printf("Atime = %d\n", (int)statbuf.st_atim.tv_sec);
     printf("Mtime = %d\n", (int)statbuf.st_mtim.tv_sec);
     printf("Ctime = %d\n", (int)statbuf.st_ctim.tv_sec);
     printf("** old Style\n");
     printf("Atime = %d\n", (int)statbuf.st_atime);
     printf("Mtime = %d\n", (int)statbuf.st_mtime);
     printf("Ctime = %d\n", (int)statbuf.st_ctime);
}
```
<br>

### ğŸ¯ fstat : íŒŒì¼ëª…ìœ¼ë¡œ íŒŒì¼ ì •ë³´ ê²€ìƒ‰
#### **1.  ì˜ˆì œ**
```
# include <sys/types.h>
# include <sys/stat.h>
# include <unistd.h>

int fstat(int fd, struct stat *statbuf);
```

#### **2. ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - fd : ì—´ë ¤ìˆëŠ” íŒŒì¼ì˜ íŒŒì¼ ê¸°ìˆ ì
    - statbuf : ê²€ìƒ‰í•œ íŒŒì¼ ì •ë³´ë¥¼ ì €ì¥í•  êµ¬ì¡°ì²´ ì£¼ì†Œ
- ë°˜í™˜ : 
    - 0 : ì„±ê³µ
    - -1 : ì‹¤íŒ¨

#### **3. ì½”ë“œ ì˜ˆì œ**
```
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {
     int fd;
     struct stat statbuf;

     fd = open("test.txt", O_RDONLY);
     if (fd == -1) {
         perror("open: linux.txt");
         exit(1);
     }

     fstat(fd, &statbuf);

     printf("Inode = %d\n", (int)statbuf.st_ino);
     printf("UID = %d\n", (int)statbuf.st_uid);
     close(fd);
}

```
<br>

## 6ï¸âƒ£ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ ì œì–´
### ğŸ¯ st_modeì˜ êµ¬ì¡°
![stat êµ¬ì¡°](image-3.png)
- st_mode í•­ëª©ì˜ ë°ì´í„°í˜•ì¸ mode_tëŠ” unsigned intë¡œ ì •ì˜ ë˜ì–´ìˆë‹¤.
- 16 bit 

#### 1. íŠ¹ìˆ˜ ì ‘ê·¼ ê¶Œí•œ
    - ìœ íš¨ ì‚¬ìš©ì(ê·¸ë£¹) ì‹ë³„ ë²ˆí˜¸ : íŒŒì¼ì˜ ì‹¤ì œ ì†Œìœ ê¶Œì„ ê°–ëŠ” ì‚¬ìš©ìì˜ ì‹ë³„ë²ˆí˜¸
    - ì§„ì§œ ì‚¬ìš©ì(ê·¸ë£¹) ì‹ë³„ ë²ˆí˜¸ : ì‹¤ì œë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°–ëŠ” ì‚¬ìš©ìì˜ ì‹ë³„ë²ˆí˜¸

#### 2. ì†Œìœ ì/ê·¸ë£¹/ê¸°íƒ€ ì‚¬ìš©ì ì ‘ê·¼ ê¶Œí•œ
- **set user-id** (04000) : ìƒì„±ëœ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ê·¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘ì‹œí‚¨ ì‚¬ìš©ìì˜ uid ëŒ€ì‹  íŒŒì¼ ì†Œìœ ìì˜ ìœ íš¨ ì‚¬ìš©ì ì‹ë³„ë²ˆí˜¸ë¥¼ ë¶€ì—¬
- **set group-id** (02000)
- **sticky bit** (01000) : ê³µìœ  ë””ë ‰í† ë¦¬(/tmp)ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ or í…ìŠ¤-ì´ë¯¸ì§€ë¥¼ swap ì˜ì—­ì— ë‚¨ê²¨ë‘ 

### ğŸ¯ íŒŒì¼ ì¢…ë¥˜ ê²€ìƒ‰
#### 1. ìƒìˆ˜ë¥¼ ì´ìš©í•œ íŒŒì¼ ì¢…ë¥˜ ê²€ìƒ‰
| ìƒìˆ˜ëª… | ìƒìˆ˜ê°’ | ê¸°ëŠ¥ |
| :---: | :---: | :---: |
| S_IFMT | 0170000  | íŒŒì¼ì˜ ì¢…ë¥˜ ë¹„íŠ¸ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ë¹„íŠ¸ë§ˆìŠ¤í¬ |
| S_IFSOCK | 0140000 | ì†Œì¼“ íŒŒì¼ |
| S_IFLNK | 0120000 | ì‹¬ë²Œë¦­ ë§í¬ íŒŒì¼ |
| S_IFREG | 0100000 | ì¼ë°˜ íŒŒì¼ |
| S_IFBLK | 0060000 | ë¸”ë¡ ì¥ì¹˜ íŠ¹ìˆ˜ íŒŒì¼ |
| S_IFDIR | 0040000 | ë””ë ‰í„°ë¦¬ |
| S_IFCHR | 0020000 | ë¬¸ì ì¥ì¹˜ íŠ¹ìˆ˜ íŒŒì¼ |
| S_IFIFO | 0010000 | FIFO íŒŒì¼ |

```
#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>

int main() {
     struct stat statbuf;
     int kind;

     stat("test.txt", &statbuf);

     printf("Mode = %o\n", (unsigned int)statbuf.st_mode);

     kind = statbuf.st_mode & S_IFMT;
     printf("Kind = %o\n", kind);

     switch (kind) {
        case S_IFLNK:
          printf("test.txt: Symbolic Link\n");
          break;
        case S_IFDIR:
          printf("test.txt: Directory\n");
          break;
        case S_IFREG:
          printf("test.txt: Regular File\n");
          break;
     }
}
```

r:read

w:write

x:execute

7 -> rwx ì „ë¶€ ì‹¤í–‰ ê°€ëŠ¥(111)

6 -> rwë§Œ ì‹¤í–‰ ê°€ëŠ¥ (110)

0 -> ê¶Œí•œ x

`ls -al íŒŒì¼ëª…` ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥

#### 2. ë§¤í¬ë¡œë¥¼ ì´ìš©í•œ íŒŒì¼ ì¢…ë¥˜ ê²€ìƒ‰
| ë§¤í¬ë¡œëª… | ë§¤í¬ë¡œ ì •ì˜ | ê¸°ëŠ¥ |
| :---: | :---: | :---: |
| S_ISLNK(m) | (((m)&S_IFMT) == S_IFLNK) | ì°¸ : ì‹¬ë²Œë¦­ ë§í¬ íŒŒì¼ |
| S_ISREG(m) | (((m)&S_IFMT) == S_IFEG) | ì°¸ : ì¼ë°˜ íŒŒì¼ |
| S_ISDIR(m) | (((m)&S_IFMT) == S_IFDIR) | ì°¸ : ë””ë ‰í„°ë¦¬ |
| S_ISCHR(m) | (((m)&S_IFMT) == S_IFCHR) | ì°¸ : ë¬¸ì ì¥ì¹˜ íŠ¹ìˆ˜ íŒŒì¼ |
| S_ISBLK(m) | (((m)&S_IFMT) == S_IFBLK) | ì°¸ : ë¸”ë¡ ì¥ì¹˜ íŠ¹ìˆ˜ íŒŒì¼ |
| S_ISFIFO(m) | (((m)&S_IFMT) == S_IFIFO) | ì°¸ : FIFO íŒŒì¼ |
| S_ISSOCK(m) | (((m)&S_IFMT) == S_IFSOCK) | ì°¸ : ì†Œì¼“ íŒŒì¼ |

```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main() {
     char *cwd;

     cwd = getcwd(NULL, BUFSIZ);
     printf("1.Current Directory: %s\n", cwd);

     chdir("testdir");

     cwd = getcwd(NULL, BUFSIZ);
     printf("2.Current Directory: %s\n", cwd);

     free(cwd);
}
```
<br>

### 3. ìƒìˆ˜ë¥¼ ì´ìš©í•œ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ ê²€ìƒ‰
- st_modeê°’ì„ ì™¼ìª½ìœ¼ë¡œ 3ë¹„íŠ¸ ì´ë™ì‹œí‚¨ í›„ and ì—°ì‚°ì„ ìˆ˜í–‰í•˜ì—¬ ì ‘ê·¼ ê¶Œí•œ ê²€ìƒ‰

    `st_mode & (S_IREAD >> 3)`

- shif ì—°ì‚° ëŒ€ì‹  ì§ì ‘ and ì—°ì‚°ìœ¼ë¡œë„ í•  ìˆ˜ ìˆë‹¤
    | ë§¤í¬ë¡œëª… | ë§¤í¬ë¡œ ì •ì˜ | ê¸°ëŠ¥ |
    | :---: | :---: | :---: |
    | S_IRWXU | 00700 | ì†Œìœ ì ì½ê¸°/ì“°ê¸°/ì‹¤í–‰ |
    | S_IRUSR | 00400 | ì†Œìœ ì ì½ê¸° |
    | S_IWUSR | 00200 | ì†Œìœ ì ì“°ê¸° |
    | S_IXUSR | 00100 | ì†Œìœ ì ì‹¤í–‰ |
    | S_IRWXG | 00070 | ê·¸ë£¹ ì½ê¸°/ì“°ê¸°/ì‹¤í–‰ |
    | S_IRGRP | 00040 | ê·¸ë£¹ ì½ê¸° |
    | S_IWGRP | 00020 | ê·¸ë£¹ ì“°ê¸° |
    | S_IXGRP | 00010 | ê·¸ë£¹ ì‹¤í–‰ |
    | S_IRWXO | 00007 | ê¸°íƒ€ ì‚¬ìš©ì ì½ê¸°/ì“°ê¸°/ì‹¤í–‰ |
    | S_IROTH | 00004 | ê¸°íƒ€ ì‚¬ìš©ì ì½ê¸° |
    | S_IWOTH | 00002 | ê¸°íƒ€ ì‚¬ìš©ì ì“°ê¸° |
    | S_IXOTH | 00001 | ê¸°íƒ€ ì‚¬ìš©ì ì‹¤í–‰ |

    ```
    #include <sys/types.h>
    #include <sys/stat.h>
    #include <stdio.h>

    int main() {
        struct stat statbuf;

        stat("test.txt", &statbuf);
            printf("Mode = %o\n", (unsigned int)statbuf.st_mode);

        if ((statbuf.st_mode & S_IREAD) != 0)
            printf("test.txt: User has a read permission\n");

        if ((statbuf.st_mode & (S_IREAD >> 3)) != 0)
            printf("test.txt: Group has a read permission\n");

        if ((statbuf.st_mode & S_IROTH) != 0)
            printf("test.txt: Other have a read permission\n");
    }
    ```
<br>

### ğŸ¯ í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ì ‘ê·¼ ê¶Œí•œ ê²€ìƒ‰ : access
#### **1. ì˜ˆì œ**
```
# include <unistd.h>

int access(const char *pathname, int mode);
```
- pathnameì— ìˆëŠ” íŒŒì¼ì´ modeë¡œ ì§€ì •í•œ ê¶Œí•œì„ ì§€ë‹ˆëŠ”ì§€ í™•ì¸
- ìœ íš¨ ì‚¬ìš©ì IDê°€ ì•„ë‹Œ ì‹¤ì œ ì‚¬ìš©ì IDì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œë§Œ í™•ì¸

#### **2. ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - pathname : ì ‘ê·¼ê¶Œí•œì„ ì•Œê³ ìí•˜ëŠ” íŒŒì¼ì˜ ê²½ë¡œ
    - mode : ì ‘ê·¼ ê¶Œí•œ
        - R_OK : ì½ê¸° ê¶Œí•œ í™•ì¸
        - W_OK : ì“°ê¸° ê¶Œí•œ í™•ì¸
        - X_OK : ì‹¤í–‰ ê¶Œí™˜ í™•ì¸
        - F_OK : íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
- ë°˜í™˜ : 
    - 0 : ì„±ê³µ
    - -1 : ì‹¤íŒ¨

#### **3. ì½”ë“œ ì˜ˆì œ**
```
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/errno.h>
#include <unistd.h>
#include <stdio.h>

extern int errno;

int main() {

        int per;

        if (access("test.bak", F_OK) == -1 && errno == ENOENT)
                printf("test.bak : File not exist.\n");

        per = access("test.txt", R_OK);
        if (per == 0)
                printf("test.txt : Read permission is permitted.\n");
        else if (per == -1 && errno == EACCES)
                printf("test.txt : Read permission is not permitted.\n");

}
```

### ğŸ¯ íŒŒì¼ëª…ìœ¼ë¡œ ì ‘ê·¼ ê¶Œí•œ ë³€ê²½ : chmod
#### **1.  ì˜ˆì œ**
```
# include <sys/stat.h>

int chmod(const char *pathname, mode_t mode)
```
- íŠ¹ìˆ˜ ì ‘ê·¼ ê¶Œí•œ ë³€ê²½ì‹œ S_ISUID, S_ISGID, S_ISVTX ì‚¬ìš©
- ì†Œìœ ì/ê·¸ë£¹/ê¸°íƒ€ ì‚¬ìš©ìì˜ ì ‘ê·¼ ê¶Œí•œì„ ë³€ê²½ì‹œ ìƒìˆ˜ ì‚¬ìš©

#### **2. ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - pathname : ì ‘ê·¼ ê¶Œí•œì„ ë³€ê²½í•˜ë ¤ëŠ” íŒŒì¼ ê²½ë¡œ
    - mode : ì ‘ê·¼ ê¶Œí•œ íŒŒì¼ì˜ ì ‘ê·¼ ê¶Œí•œì„ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œ í˜¸ì¶œ
- ë°˜í™˜ : 
    - 0 : ì„±ê³µ
    - -1 : ì‹¤íŒ¨

#### **3. ì½”ë“œ ì˜ˆì œ**
```
# ì ‘ê·¼ ê¶Œí•œ ë³€ê²½
chmod(pathname, S_IRWXU);
chmod(pathname, S_IRWXU | S_IRGRP | S_IXGRP | X_IROTH);

# ê¸°ì¡´ ê¶Œí•œ ë³€ê²½
mode |= S_IWGRP;

# ì ‘ê·¼ ê¶Œí•œ ì œê±°
mode &= ~(S_IORTH);

# modeê°’ì„ ë³€ê²½í•œ í›„ chmod() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ ë³€ê²½ëœ ì ‘ê·¼ ê¶Œí•œì´ ì ìš©ë¨
chmod(pathname, mode);
```

```
#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>

int main() {
    struct stat statbuf;

    chmod("test.txt", S_IRWXU|S_IRGRP|S_IXGRP|S_IROTH);

    stat("test.txt", &statbuf);
    printf("1.Mode = %o\n", (unsigned int)statbuf.st_mode);

    statbuf.st_mode |= S_IWGRP;
    statbuf.st_mode &= ~(S_IROTH);

    chmod("test.txt", statbuf.st_mode);

    stat("test.txt", &statbuf);
    printf("2.Mode = %o\n", (unsigned int)statbuf.st_mode);
}
```

### ğŸ¯ íŒŒì¼ê¸°ìˆ ìë¡œ ì ‘ê·¼ ê¶Œí•œ ë³€ê²½ : fchmod
#### **1.  ì˜ˆì œ**
```
# include <sys/stat.h>

int fchmod(int fd, mode_t mode);
```
- ì—´ë ¤ìˆëŠ” íŒŒì¼ì˜ íŒŒì¼ ê¸°ìˆ ìë¥¼ ë°›ì•„ ì ‘ê·¼ ê¶Œí•œì„ ë³€ê²½

#### **2. ì¸ìê°’ì™€ ë°˜í™˜ê°’**
- ì¸ì : 
    - fd : ì—´ë ¤ìˆëŠ” íŒŒì¼ì˜ íŒŒì¼ ê¸°ìˆ ì
    - mode : ì ‘ê·¼ ê¶Œí•œ
- ë°˜í™˜ : 
    - 0 : ì„±ê³µ
    - -1 : ì‹¤íŒ¨

---
```
ì´ê±° ë¬´ì—‡
ls -al test.txt
ls -al > test.txt
ls -al >>> test.txt

*** ì‹œí—˜ ë‚´ìš©!!! ***
ls -al > sample.txt
ls -al sample.txt
chmod u+x, g+w, o+w sample.txt <- íŒŒì¼ ê¶Œí•œ ë³€ê²½
chmod g-w, o-w sample.txt
chmod 0640 sample.txt <- ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ê¶Œí•œ ë°”ê¾¸ê¸°

chmod u+s sample.txt <- 
chmod u-x sample.txt
ls -al sample.txt <- sê°€ ëŒ€ë¬¸ìë¡œ ë°”ë€Œì—ˆì„ ê²ƒ

chmod g+s sample.txt
ls -al sample.txt <- ëŒ€ë¬¸ì Sê°€ ì¶”ê°€ë˜ì—ˆì„ ê²ƒ
chmod o+t sample.txt 
ls -al sample.txt <- ëŒ€ë¬¸ì Tê°€ ì¶”ê°€ë˜ì—ˆì„ ê²ƒ
chmod o+x sample.txt
ls -al sample.txt <- ì†Œë¬¸ì të¡œ ë°”ë€Œì—ˆì„ ê²ƒ
chmod 7644 sample.txt 
ls -al sample.txt <- ëª¨ë“  íŠ¹ìˆ˜ ê¶Œí•œì´ ë°”ë€Œì—ˆì„ ê²ƒ
```
