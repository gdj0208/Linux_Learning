
# í™˜ê²½ ë³€ìˆ˜

## 1ï¸âƒ£ í™˜ê²½ ë³€ìˆ˜ì˜ í™œìš©



### ğŸ¯ í™˜ê²½ ë³€ìˆ˜ì˜ ì´í•´
- í™˜ê²½ë³€ìˆ˜ëŠ” `í™˜ê²½ë³€ìˆ˜ëª…=ê°’`ì˜ í˜•íƒœë¡œ êµ¬ì„±
- í™˜ê²½ë³€ìˆ˜ëª…ì€ ê´€ë¡€ì ìœ¼ë¡œ ëŒ€ë¬¸ì
``` 
$ env 
```



### ğŸ¯ ì „ì—­ ë³€ìˆ˜ ì‚¬ìš© : environ
```
#include <unistd.h>
extern char **environ;
```
- environ : í™˜ê²½ë³€ìˆ˜ ì „ì²´ì— ëŒ€í•œ í¬ì¸í„°

#### [ 2. ì˜ˆì‹œ ì½”ë“œ ]
```
// ex_1.c

#include <unistd.h>
#include <stdio.h>

extern char **environ;

int main() {
    char **env;

    env = environ;
    while (*env) {
        printf("%s\n", *env);
        env++;
    }
}
```



### ğŸ¯ main() í•¨ìˆ˜ ì¸ì í™œìš©

#### [ 1. ì„¤ëª… ]
```
int main(int argc, char **argv, char **envp)
```
- environ()ê³¼ ê°™ì€ ì‚¬ìš©ë²•

#### [2. ì½”ë“œ ì˜ˆì‹œ ]
```
// ex_2.c

#include <stdio.h>

int main(int argc, char **argv, char **envp) {
     char **env;

     env = envp;
     while (*env) {
         printf("%s\n", *env);
         env++;
     }
}
```



### ğŸ¯ í™˜ê²½ ë³€ìˆ˜ ê²€ìƒ‰ : getenv()

#### [ 1. ì„¤ëª… ]
```
#include <stdlib.h>

char *getnev(const char *name);
```
- name : í™˜ê²½ ë³€ìˆ˜ëª…
- shell ì‚¬ìš©ì‹œ `echo`ë„ ì‚¬ìš© ë°©ë²•ì´ ë  ìˆ˜ ìˆë‹¤! 

#### [ 2. ì½”ë“œ ì˜ˆì‹œ ]
```
// ex_3.c

#include <stdlib.h>
#include <stdio.h>

int main() {
    char *val;

    val = getenv("SHELL");
    if (val == NULL)
        printf("SHELL not defined\n");
    else
        printf("SHELL = %s\n", val);
}
```

### ğŸ¯ í™˜ê²½ ë³€ìˆ˜ ì„¤ì • : putenv()

#### [ 1. ì„¤ëª… ]
```
#include <stdlib.h>

int putenv(char *string);
```
- string : ì„¤ì •í•  í™˜ê²½ ë³€ìˆ˜ì™€ ê°’ìœ¼ë¡œ êµ¬ì„±í•œ ë¬¸ìì—´
- í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë§Œ ë³€ê²½ë˜ê³  ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì˜ í™˜ê²½ë³€ìˆ˜ëŠ” ì„¤ì •ë˜ì§€ ì•ŠëŠ”ë‹¤!

#### [ 2. ì½”ë“œ ì˜ˆì‹œ ]
```
// ex_4.c

#include <stdlib.h>
#include <stdio.h>

int main() {
    char *val;

    val = getenv("TERM");
    if (val == NULL)
        printf("TERM not defined\n");
    else
        printf("1. TERM = %s\n", val);

    putenv("TERM=vt100");

    val = getenv("TERM");
    printf("2. TERM = %s\n", val);
}
```

### ğŸ¯ í™˜ê²½ ë³€ìˆ˜ ì„¤ì • : setenv()

#### [ 1. ì„¤ëª… ]
```
#include <stdlib.h>

int setnev(const char *name, const char *value, int overwirte);
```
- name : í™˜ê²½ ë³€ìˆ˜ëª…
- value : í™˜ê²½ ë³€ìˆ˜ê°’
- overwirte : ë®ì–´ì“°ê¸° ì—¬ë¶€
    - overwirte == 0 : ë®ì–´ì“°ê¸° O
    - overwirte != 0 : ë®ì–´ì“°ê¸° X

#### [ 2. ì½”ë“œ ì˜ˆì‹œ ]
```
// ex_5.c

#include <stdlib.h>
#include <stdio.h>

int main() {
    char *val;

    val = getenv("TERM");
    if (val == NULL)
        printf("TERM not defined\n");
    else
        printf("1. TERM = %s\n", val);

    setenv("TERM","vt100", 0);
    val = getenv("TERM");
    printf("2. TERM = %s\n", val);

    setenv("TERM","vt100", 1);
    val = getenv("TERM");
    printf("3. TERM = %s\n", val);
}
```

### ğŸ¯ í™˜ê²½ ë³€ìˆ˜ ì‚­ì œ : unseteenv()

#### [ 1. ì„¤ëª… ]
```
#include <stdlib.h>

int unsetenv(const char *name);
```
- name : í™˜ê²½ë³€ìˆ˜ëª…
- nameì— ì§€ì •í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚­ì œ

---

# í˜¸í™˜ì„± ëª¨ë“œ

## 1ï¸âƒ£ ê°œìš”



### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ìƒì„±ê³¼ ì¢…ë£Œ

#### [ 1. í”„ë¡œì„¸ìŠ¤ ìƒì„± ]
í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¡œëŠ” system(), fork(), vfork() ë“±ì´ ìˆìŒ
```
int system(const char *command);    // í”„ë¡œê·¸ë¨ ì‹¤í–‰
pid_t fork(void);                   // í”„ë¡œì„¸ìŠ¤ ìƒì„±
pid_t vfork(void);                  // í”„ë¡œì„¸ìŠ¤ ìƒì„±
```

#### [ 2. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ]
ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œì‹œ ì¢…ë£Œ ìƒíƒœë¥¼ ì €ì¥í•¨

ìì‹ í”„ë¡œì„¸ìŠ¤ëŠ” ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ì–´ë–»ê²Œ ì¢…ë£Œë˜ì—ˆëŠ”ì§€ë¥¼ ì•Œë¦¼

```
// í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
void exit(int status);
void _exit(int status);     

// ì¢…ë£Œì‹œ ìˆ˜í–‰í•  ì‘ì—… ì§€ì •
int atexit(void (*function)(void))      
int on_exit(void (*function)(int, void *), void *arg);
```



### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™” : wait()

**[ ì˜ˆì‹œ ì½”ë“œ ]**
```
#include <sy/types.h>
#include <sys/wait.h>

pid_t wait(int *wstatus)
```
- wstatus : ìƒíƒœ ì •ë³´ë¥¼ ì €ì¥í•  ì£¼ì†Œ

**[ wait() í•¨ìˆ˜ì˜ ì •ë³´ ]**
- ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œí•  ë•Œê¹Œì§€ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¸°ë‹¤ë¦¬ê²Œí•¨
- ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ì¢…ë£Œ ìƒíƒœëŠ” wstatusì— ì§€ì •í•œ ì£¼ì†Œì— ì €ì¥ (NULL ê°€ëŠ¥)
- ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ wait() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ì— ìì‹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œì‹œ ì¦‰ì‹œ ë¦¬í„´
    - ë°˜í™˜ê°’ : ìì‹ í”„ë¡œì„¸ìŠ¤ PID (ì—†ì„ ì‹œ -1)

**[ wait() ì½”ë“œ ì˜ˆì‹œ ]**
```
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main() {
    int status;
    pid_t pid;

    switch (pid = fork()) {
        case -1 : /* fork failed */
            perror("fork");
            exit(1);
            break;
        case 0 : /* child process */
            printf("--> Child Process\n");
            exit(2);
            break;
        default : /* parent process */
            while (wait(&status) != pid)
                continue;
            printf("--> Parent process\n");
            printf("Status: %d, %x\n", status, status);
            printf("Child process Exit Status:%d\n", status >> 8);
            break;
    }
}
```



### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™” : waitpid()

**[ ì˜ˆì‹œ ì½”ë“œ ]**
```
#include <sys/types.h>
#include <sys/wait.h>

pid_t waitpid(pid_t pid, int *wstatus, int options)
```
- pid : ì¢…ë£Œë¥¼ ê¸°ë‹¤ë¦¬ëŠ” pid
    - pid < -1 : ë™ì¼ PGDì— ì†í•œ ìì‹ í”„ë¡œì„¸ìŠ¤ ì¤‘ ì„ì˜ì˜ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœê°’ì„ ìš”ì²­
    - pid == -1 : ì„ì˜ì˜ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœê°’ ìš”ì²­
    - pid == 0 : ê°™ì€ PGIDì— ì†í•œ ì„ì˜ì˜ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœê°’ì„ ìš”ì²­
    - pid > 0 : ì§€ì •í•œ pidì— í•´ë‹¹í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ ìƒíƒœê°’ì„ ìš”ì²­
- status : ì¢…ë£Œ ìƒíƒœê°’ì„ ì €ì¥í•  ì£¼ì†Œ
- options : wait() í•¨ìˆ˜ì˜ ë¦¬í„´ ì¡°ê±´

**[ waitpid() í•¨ìˆ˜ ì •ë³´ ]**
- ìì‹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œì˜ statusì— ì €ì¥
- optionsì˜ ì¡°ê±´ì— ë”°ë¼ ë¦¬í„´

**[ waitpid()ì˜ ì˜ˆì‹œ ]**
```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/time.h>

main() {

	int status;
	pid_t pid;
#ifdef TIMES
	struct timeval stime,etime;
	int time_result;
#endif
	if ((pid = fork()) < 0) {
		perror("fork");
		exit(1);
	}
#ifdef TIMES
	gettimeofday(&stime, NULL);
#endif

	if (pid == 0) {
		printf("--> Child process\n");
		sleep(3);
		exit(3);
	}
#ifdef TIMES
	gettimeofday(&etime, NULL);
	time_result = etime.tv_usec - stime.tv_usec;
	printf("TIMES == %ld %ld %ld\n", etime.tv_usec, stime.tv_usec, time_result);
#endif
	printf("--> Parent process\n");

	while (waitpid(pid, &status, WNOHANG) == 0) {
		printf("Parent still wait..\n");
		sleep(1);
	}
	printf("Child Exit Status : %d\n", status>>8);

}
```





## 2ï¸âƒ£ í”„ë¡œì„¸ìŠ¤ ìƒì„±

### ğŸ¯ í”„ë¡œê·¸ë¨ ì‹¤í–‰ : system()

### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ìƒì„± : fork() 
#### [ 1. ì„¤ëª… ]

#### [ 2. ì½”ë“œ ì˜ˆì‹œ ]

### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ : exit()


## 3ï¸âƒ£ exec í•¨ìˆ˜êµ° í™œìš©
### ğŸ¯ exec í•¨ìˆ˜êµ°ì˜ í˜•íƒœ
```
#include <unistd.h>

int execl(const char *pathname, const char *arg, /*(char *)NULL*/);

int execlp(const char *file, const char *arg, /*(char *)NULL*/);

int execle(const char *pathname, const char *arg, /*(char *)NULL, char *const envp[] */);    // í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê°€ëŠ¥

int execv(const char *pathname, const char *argv[]);

int execvp(const char *file, const char *arg);

int execvpe(const char *file, const char *arg, /*(char *)NULL*/);
```

```
ex_6.c
```






fork()ì™€ execlp() ì´ìš©í•˜ê¸°

## 4ï¸âƒ£ í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™”
### ğŸ¯ ì¢€ë¹„ í”„ë¡œì„¸ìŠ¤

### ğŸ¯ í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™” : wait()
- ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œí•  ë•Œê¹Œì§€ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ ëŒ€ê¸° -> ì¢€ë¹„ í”„ë¡œì„¸ìŠ¤ ë°©ì§€